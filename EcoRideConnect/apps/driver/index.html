<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
  <meta name="description" content="WARGO Partner Driver Application" />
  <meta name="theme-color" content="#000000" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <title>WARGO PARTNER - Driver App</title>
  </head>
  <body>
    <div id="app-error" style="display:none;position:fixed;bottom:12px;left:12px;right:12px;padding:10px;border-radius:8px;background:#fee2e2;color:#7f1d1d;font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;z-index:9999"></div>
    <div id="root"></div>
    <script type="module" src="/main.tsx"></script>
    <script>
      // Force clear cache and reload on version change
      (function() {
        const APP_VERSION = '2025-12-02-v2';
        const STORAGE_KEY = 'wargo-driver-version';
        const lastVersion = localStorage.getItem(STORAGE_KEY);
        
        // Unregister service workers
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
              registration.unregister();
            }
          });
        }
        
        // If version changed, clear everything and force reload
        if (lastVersion !== APP_VERSION) {
          // Clear all caches
          if ('caches' in window) {
            caches.keys().then(function(names) {
              names.forEach(function(name) {
                caches.delete(name);
              });
            });
          }
          
          localStorage.setItem(STORAGE_KEY, APP_VERSION);
          
          // Force a hard reload bypassing cache
          if (lastVersion) {
            window.location.reload(true);
          }
        }
      })();
    </script>
    <script>
      (function(){
        const el = document.getElementById('app-error');
        function show(msg){
          el.textContent = 'There was a problem loading the app: ' + msg + ' (check network console for details)';
          el.style.display = 'block';
        }
        window.addEventListener('error', (e) => {
          const t = e?.message || (e?.error && e.error.message) || 'Unknown error';
          show(t);
        });
        window.addEventListener('unhandledrejection', (e) => {
          const t = (e && e.reason && (e.reason.message || String(e.reason))) || 'Unknown rejection';
          show(t);
        });
      })();
    </script>
  </body>
</html>
